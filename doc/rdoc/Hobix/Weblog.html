<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Hobix::Weblog - The Book of Hobix</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/navigation.js" defer></script>
<script src="../js/search.js" defer></script>
<script src="../js/search_index.js" defer></script>
<script src="../js/searcher.js" defer></script>
<script src="../js/darkfish.js" defer></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">




<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#class-Hobix::Weblog-label-Properties">Properties</a>
    <li><a href="#class-Hobix::Weblog-label-Regeneration">Regeneration</a>
    <li><a href="#class-Hobix::Weblog-label-Skel+Methods">Skel Methods</a>
    <li><a href="#class-Hobix::Weblog-label-Examples">Examples</a>
    <li><a href="#class-Hobix::Weblog-label-Example+1-3A+Viewing+Configuration">Example 1: Viewing Configuration</a>
    <li><a href="#class-Hobix::Weblog-label-Example+2-3A+Adding+a+Template+Prefix">Example 2: Adding a Template Prefix</a>
    <li><a href="#class-Hobix::Weblog-label-The+page_storage+variable">The page_storage variable</a>
  </ul>
</div>


  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">Object
  
</div>

    <div id="includes-section" class="nav-section">
  <h3>Included Modules</h3>

  <ul class="link-list">
  
  
    <li><a class="include" href="BaseProperties.html">Hobix::BaseProperties</a>
  
  
  </ul>
</div>

    <div id="extends-section" class="nav-section">
  <h3>Extended With Modules</h3>

  <ul class="link-list">
    
  
    <li><a class="extend" href="UriStr.html">Hobix::UriStr</a>
  
  
  
    <li><a class="extend" href="EntryEnum.html">Hobix::EntryEnum</a>
  
  
  
    <li><a class="extend" href="Enumerable.html">Hobix::Enumerable</a>
  
  
  
    <li><a class="extend" href="Enumerable.html">Hobix::Enumerable</a>
  
  
  
    <li><a class="extend" href="Enumerable.html">Hobix::Enumerable</a>
  
  
  
    <li><a class="extend" href="Enumerable.html">Hobix::Enumerable</a>
  
  
  </ul>
</div>

    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-add_entry_class">::add_entry_class</a>
    
    <li ><a href="#method-c-load">::load</a>
    
    <li ><a href="#method-i-authorize">#authorize</a>
    
    <li ><a href="#method-i-build_pages">#build_pages</a>
    
    <li ><a href="#method-i-central_ext">#central_ext</a>
    
    <li ><a href="#method-i-central_prefix">#central_prefix</a>
    
    <li ><a href="#method-i-commit_to_git">#commit_to_git</a>
    
    <li ><a href="#method-i-default_central_ext">#default_central_ext</a>
    
    <li ><a href="#method-i-default_central_prefix">#default_central_prefix</a>
    
    <li ><a href="#method-i-default_entry_class">#default_entry_class</a>
    
    <li ><a href="#method-i-default_entry_path">#default_entry_path</a>
    
    <li ><a href="#method-i-default_index_class">#default_index_class</a>
    
    <li ><a href="#method-i-default_lib_path">#default_lib_path</a>
    
    <li ><a href="#method-i-default_output_path">#default_output_path</a>
    
    <li ><a href="#method-i-default_skel_path">#default_skel_path</a>
    
    <li ><a href="#method-i-entry_class">#entry_class</a>
    
    <li ><a href="#method-i-entry_path">#entry_path</a>
    
    <li ><a href="#method-i-expand_path">#expand_path</a>
    
    <li ><a href="#method-i-facet_for">#facet_for</a>
    
    <li ><a href="#method-i-facets">#facets</a>
    
    <li ><a href="#method-i-index_class">#index_class</a>
    
    <li ><a href="#method-i-join_path">#join_path</a>
    
    <li ><a href="#method-i-lib_path">#lib_path</a>
    
    <li ><a href="#method-i-link">#link</a>
    
    <li ><a href="#method-i-linklist">#linklist</a>
    
    <li ><a href="#method-i-load_and_validate_entry">#load_and_validate_entry</a>
    
    <li ><a href="#method-i-method_missing">#method_missing</a>
    
    <li ><a href="#method-i-output_entry_map">#output_entry_map</a>
    
    <li ><a href="#method-i-output_map">#output_map</a>
    
    <li ><a href="#method-i-output_path">#output_path</a>
    
    <li ><a href="#method-i-outputs">#outputs</a>
    
    <li ><a href="#method-i-p_publish">#p_publish</a>
    
    <li ><a href="#method-i-publishers">#publishers</a>
    
    <li ><a href="#method-i-regenerate">#regenerate</a>
    
    <li ><a href="#method-i-reset_output_map">#reset_output_map</a>
    
    <li ><a href="#method-i-retouch">#retouch</a>
    
    <li ><a href="#method-i-save">#save</a>
    
    <li ><a href="#method-i-sections">#sections</a>
    
    <li ><a href="#method-i-sections_ignored">#sections_ignored</a>
    
    <li ><a href="#method-i-sections_sorts">#sections_sorts</a>
    
    <li ><a href="#method-i-setup">#setup</a>
    
    <li ><a href="#method-i-skel_daily">#skel_daily</a>
    
    <li ><a href="#method-i-skel_entry">#skel_entry</a>
    
    <li ><a href="#method-i-skel_index">#skel_index</a>
    
    <li ><a href="#method-i-skel_monthly">#skel_monthly</a>
    
    <li ><a href="#method-i-skel_path">#skel_path</a>
    
    <li ><a href="#method-i-skel_section">#skel_section</a>
    
    <li ><a href="#method-i-skel_tags">#skel_tags</a>
    
    <li ><a href="#method-i-skel_yearly">#skel_yearly</a>
    
    <li ><a href="#method-i-start">#start</a>
    
    <li ><a href="#method-i-storage">#storage</a>
    
    <li ><a href="#method-i-to_yaml_type">#to_yaml_type</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Hobix::Weblog">
  <h1 id="class-Hobix::Weblog" class="class">
    class Hobix::Weblog
  </h1>

  <section class="description">
    
<p>placed here to avoid dependency cycle between base.rb and weblog.rb</p>

<p>The <a href="Weblog.html"><code>Weblog</code></a> class is the core of <a href="../Hobix.html"><code>Hobix</code></a> scripting.  Although often you use it&#39;s <code>storage</code> accessor to get to entries, the <a href="Weblog.html"><code>Weblog</code></a> class itself contains weblog configuration information and methods for managing the weblog.</p>

<h2 id="class-Hobix::Weblog-label-Properties">Properties<span><a href="#class-Hobix::Weblog-label-Properties">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The following accessors are available for retrieving configuration data, all of which is stored in hobix.yaml.</p>
<dl class="rdoc-list note-list"><dt>title
<dd>
<p>The title of the weblog.</p>
</dd><dt>link
<dd>
<p>The absolute url to the weblog.  (When accessed through the class – weblog.link – this is returned as a URI.)</p>
</dd><dt>authors
<dd>
<p>A hash, in which keys are author&#39;s abbreviated names, paired with hashes of `name&#39;, `url&#39; and `email&#39; information.</p>
</dd><dt>contributors
<dd>
<p>Same structure as the authors hash.  For storing information on third-party contributors.</p>
</dd><dt>tagline
<dd>
<p>The short catchphrase associated with the weblog.</p>
</dd><dt>copyright
<dd>
<p>Brief copyright information.</p>
</dd><dt>period
<dd>
<p>How often is the weblog updated?  Frequency in seconds.</p>
</dd><dt>path
<dd>
<p>Complete system path to the directory containing hobix.yaml.</p>
</dd><dt>sections
<dd>
<p>Specially tagged directories which act as independent subsites or hidden categories.</p>
</dd><dt>requires
<dd>
<p>A list of required libraries, paired with possible configuration data for a library.</p>
</dd><dt><a href="Weblog.html#method-i-entry_path"><code>entry_path</code></a>
<dd>
<p>Path to entry storage.</p>
</dd><dt><a href="Weblog.html#method-i-skel_path"><code>skel_path</code></a>
<dd>
<p>Path to template&#39;s directory.</p>
</dd><dt><a href="Weblog.html#method-i-output_path"><code>output_path</code></a>
<dd>
<p>Path to output directory.</p>
</dd><dt><a href="Weblog.html#method-i-lib_path"><code>lib_path</code></a>
<dd>
<p>Path to extension library directory.</p>
</dd><dt>git
<dd>
<p>If true, regenerations will commit to git and push the site to the blahg remote.</p>
</dd></dl>

<h2 id="class-Hobix::Weblog-label-Regeneration">Regeneration<span><a href="#class-Hobix::Weblog-label-Regeneration">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>One of the primary uses of the <a href="Weblog.html"><code>Weblog</code></a> class is to coordinate regenerations of the site.  More about regeneration can be found in the documentation for the <code>regenerate</code> method.</p>

<h2 id="class-Hobix::Weblog-label-Skel+Methods">Skel Methods<span><a href="#class-Hobix::Weblog-label-Skel+Methods">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The <a href="Weblog.html"><code>Weblog</code></a> class also contains handlers for template prefixes. (Templates are usually contained in `skel&#39;).</p>

<p>Each `prefix&#39; has its accompanying skel_prefix method.  So, for `index&#39; templates (such as index.html.erb), the <a href="Weblog.html#method-i-skel_index"><code>skel_index</code></a> method is executed and passed a block which is supplied a hash by the skel method.</p>

<p>Usually this hash only needs to contain :page and :entries (or :entry) items.  Any other items will simply be added to the vars hash.</p>

<p>To give you a general idea, <a href="Weblog.html#method-i-skel_index"><code>skel_index</code></a> looks something like this:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skel_index</span>( <span class="ruby-identifier">path_storage</span>, <span class="ruby-identifier">section_path</span> )
    <span class="ruby-identifier">index_entries</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">lastn</span>( <span class="ruby-ivar">@lastn</span> )
    <span class="ruby-identifier">page</span> = <span class="ruby-constant">Page</span>.<span class="ruby-identifier">new</span>( <span class="ruby-string">&#39;index&#39;</span>, <span class="ruby-identifier">section_path</span> )
    <span class="ruby-identifier">page</span>.<span class="ruby-identifier">prev</span> = <span class="ruby-identifier">index_entries</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">created</span>.<span class="ruby-identifier">strftime</span>( <span class="ruby-string">&quot;%Y/%m/index&quot;</span> )
    <span class="ruby-identifier">page</span>.<span class="ruby-identifier">timestamp</span> = <span class="ruby-identifier">index_entries</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">created</span>
    <span class="ruby-identifier">page</span>.<span class="ruby-identifier">updated</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">last_updated</span>( <span class="ruby-identifier">index_entries</span> )
    <span class="ruby-keyword">yield</span> <span class="ruby-value">:page</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">page</span>, <span class="ruby-value">:entries</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">index_entries</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The page object is instantiated, describing where output will go. The entries list, describing which entries qualify for this prefix, is queried from storage.  We then yield back to the regeneration system with our hash.</p>

<p>Creating your own template prefixes is simply a matter of adding a new skel method for that prefix to the <a href="Weblog.html"><code>Weblog</code></a> class.</p>

<h1 id="class-Hobix::Weblog-label-Examples">Examples<span><a href="#class-Hobix::Weblog-label-Examples">&para;</a> <a href="#top">&uarr;</a></span></h1>

<h2 id="class-Hobix::Weblog-label-Example+1-3A+Viewing+Configuration">Example 1: Viewing Configuration<span><a href="#class-Hobix::Weblog-label-Example+1-3A+Viewing+Configuration">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Since configuration is stored in <a href="../YAML.html"><code>YAML</code></a>, you can generate the hobix.yaml configuration file by simply running <code>to_yaml</code> on a weblog.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;hobix/weblog&#39;</span>
<span class="ruby-identifier">weblog</span> = <span class="ruby-constant">Hobix</span><span class="ruby-operator">::</span><span class="ruby-constant">Weblog</span>.<span class="ruby-identifier">load</span>( <span class="ruby-string">&#39;/my/blahhg/hobix.yaml&#39;</span> )
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">weblog</span>.<span class="ruby-identifier">to_yaml</span>
  <span class="ruby-comment">#=&gt; --- # prints YAML configuration</span>
</pre>

<h2 id="class-Hobix::Weblog-label-Example+2-3A+Adding+a+Template+Prefix">Example 2: Adding a Template Prefix<span><a href="#class-Hobix::Weblog-label-Example+2-3A+Adding+a+Template+Prefix">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>On Hobix.com, only news entries are shown on the front page.  The site also has `about&#39; and `learn&#39; entry paths for storing the faqs and tutorials.  Although I didn&#39;t want to display the complete text of these items, I did want a sidebar to contain links to them.</p>

<p>So I added a `sidebar&#39; prefix, which loads from these entry paths. I have a sidebar.html.erb, which is included using Apache SSIs. The advantage to this approach is that when an update occurs in either of these paths, the sidebar will be updated in the next regeneration.  Rather than having to regenerate every page in the site to see the change reflected.</p>

<p>I added a `lib/hobix.com.rb&#39; to the site&#39;s `lib&#39; directory.  And in hobix.yaml, I included a line requiring this file.  The file simply contains the new skel method.</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">Hobix</span>
<span class="ruby-keyword">class</span> <span class="ruby-constant">Weblog</span>
    <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skel_sidebar</span>( <span class="ruby-identifier">path_storage</span>, <span class="ruby-identifier">section_path</span> )
        <span class="ruby-comment">## Load `about&#39; and `learn&#39; entries</span>
        <span class="ruby-identifier">abouts</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">find</span>( <span class="ruby-value">:all</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-keyword">true</span>, <span class="ruby-value">:inpath</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;about&#39;</span> ).<span class="ruby-identifier">reverse</span>
        <span class="ruby-identifier">learns</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">find</span>( <span class="ruby-value">:all</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-keyword">true</span>, <span class="ruby-value">:inpath</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;learn&#39;</span> ).<span class="ruby-identifier">reverse</span>

        <span class="ruby-comment">## Create page data</span>
        <span class="ruby-identifier">page</span> = <span class="ruby-constant">Page</span>.<span class="ruby-identifier">new</span>( <span class="ruby-string">&#39;sidebar&#39;</span>, <span class="ruby-identifier">section_path</span> )
        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">updated</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">last_updated</span>( <span class="ruby-identifier">abouts</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">learns</span> )
        <span class="ruby-keyword">yield</span> <span class="ruby-value">:page</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">page</span>, 
              <span class="ruby-value">:about_entries</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">abouts</span>, <span class="ruby-value">:learn_entries</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">learns</span>
    <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>There is a lot going on here.  I&#39;ll try to explain the most vital parts and leave the rest up to you.</p>

<p>First, storage queries don&#39;t return full <a href="Entry.html"><code>Entry</code></a> objects.  You can read more about this in the <code>Hobix::BaseStorage</code> class docs.  The storage query returns Arrays which contain each entry&#39;s id (a String) and the entry&#39;s modification time (a Time object).</p>

<p>See, the regeneration system will do the business of loading the full entries. The skel method&#39;s job is just to report which entries <strong>qualify</strong> for a template.  The regeneration system will only load those entries if an update is needed.</p>

<p>We create a <a href="Page.html"><code>Page</code></a> object, which dictates that the output will be saved to /sidebar.ext.  A modification time is discovered by passing a combined list to +Hobix::BaseStorage#last_updated+.  The <code>updated</code> property is being set to the latest timestamp among the about and learn entries.</p>

<p>PLEASE NOTE: The <code>updated</code> property is very important.  The regeneration system will use this timestamp to determine what pages need updating. See +Hobix::Weblog#regenerate+ for more.</p>

<p>We then yield to the regeneration system.  Note that any hash key which ends with `entries&#39; will have its contents loaded as full <a href="Entry.html"><code>Entry</code></a> objects, should the prefix qualify for regeneration.</p>

<h2 id="class-Hobix::Weblog-label-The+page_storage+variable">The page_storage variable<span><a href="#class-Hobix::Weblog-label-The+page_storage+variable">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The <code>page_storage</code> variable passed into the method is a trimmed copy of the +Weblog#storage+ variable.  Whereas +Weblog#storage+ gives you access to all stored entries, <code>page_storage</code> only gives you access to entries within a certain path.</p>

<p>So, if you have a template skel/index.html.quick, then this template will be passed a <code>path_storage</code> variable which encompasses all entries.  However, for template skel/friends/eric/index.html.quick will be given a <code>path_storage</code> which includes only entries in the `friends/eric&#39; path.</p>

<p>The simple rule is: if you want to have access to load from the entire weblog storage, use <code>storage</code>.  If you want your template to honor its path, use <code>path_storage</code>.  Both are <code>Hobix::BaseStorage</code> objects and respond to the same methods.</p>

  </section>

  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-hobix_yaml" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">hobix_yaml</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-path" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">path</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-add_entry_class" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_entry_class</span><span
            class="method-args">( c )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="add_entry_class-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/base.rb</span>
<span class="line-num">295</span> <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">add_entry_class</span>( <span class="ruby-identifier">c</span> )
<span class="line-num">296</span>     <span class="ruby-identifier">@@entry_classes</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">c</span>
<span class="line-num">297</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-load" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">load</span><span
            class="method-args">( hobix_yaml )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Load the weblog information from a <a href="../YAML.html"><code>YAML</code></a> file and <code>start</code> the <a href="Weblog.html"><code>Weblog</code></a>.</p>
          
          

          
          <div class="method-source-code" id="load-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">411</span> <span class="ruby-keyword">def</span> <span class="ruby-constant">Weblog</span><span class="ruby-operator">::</span><span class="ruby-identifier ruby-title">load</span>( <span class="ruby-identifier">hobix_yaml</span> )
<span class="line-num">412</span>     <span class="ruby-identifier">hobix_yaml</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>( <span class="ruby-identifier">hobix_yaml</span> )
<span class="line-num">413</span>     <span class="ruby-identifier">weblog</span> = <span class="ruby-constant">YAML</span><span class="ruby-operator">::</span><span class="ruby-identifier">load</span>( <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-identifier">open</span>( <span class="ruby-identifier">hobix_yaml</span> ) )
<span class="line-num">414</span>     <span class="ruby-identifier">weblog</span>.<span class="ruby-identifier">start</span>( <span class="ruby-identifier">hobix_yaml</span> )
<span class="line-num">415</span>     <span class="ruby-identifier">weblog</span>
<span class="line-num">416</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-authorize" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">authorize</span><span
            class="method-args">( user, pass )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="authorize-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">853</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">authorize</span>( <span class="ruby-identifier">user</span>, <span class="ruby-identifier">pass</span> )
<span class="line-num">854</span>     <span class="ruby-identifier">require</span> <span class="ruby-string">&#39;digest/sha1&#39;</span>
<span class="line-num">855</span>     <span class="ruby-identifier">authors</span>[<span class="ruby-identifier">user</span>][<span class="ruby-string">&#39;password&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">SHA1</span>.<span class="ruby-identifier">new</span>( <span class="ruby-identifier">pass</span> )
<span class="line-num">856</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-build_pages" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">build_pages</span><span
            class="method-args">( page_name ) { |vars| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Used by <code>regenerate</code> to construct the vars hash by calling the appropriate skel method for each page.</p>
          
          

          
          <div class="method-source-code" id="build_pages-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">432</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">build_pages</span>( <span class="ruby-identifier">page_name</span> )
<span class="line-num">433</span>     <span class="ruby-identifier">vars</span> = {}
<span class="line-num">434</span>     <span class="ruby-identifier">paths</span> = <span class="ruby-identifier">page_name</span>.<span class="ruby-identifier">split</span>( <span class="ruby-string">&#39;/&#39;</span> )
<span class="line-num">435</span>     <span class="ruby-identifier">loop</span> <span class="ruby-keyword">do</span>
<span class="line-num">436</span>         <span class="ruby-identifier">try_page</span> = <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">join</span>( <span class="ruby-string">&#39;_&#39;</span> ).<span class="ruby-identifier">gsub</span>(<span class="ruby-string">&#39;-&#39;</span>,<span class="ruby-string">&#39;_&#39;</span>)
<span class="line-num">437</span>         <span class="ruby-keyword">if</span> <span class="ruby-identifier">respond_to?</span> <span class="ruby-node">&quot;skel_#{ try_page }&quot;</span>
<span class="line-num">438</span>             <span class="ruby-identifier">section_path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>( <span class="ruby-identifier">page_name</span> )
<span class="line-num">439</span>             <span class="ruby-identifier">path_storage</span> = <span class="ruby-identifier">storage</span>.<span class="ruby-identifier">path_storage</span>( <span class="ruby-identifier">section_path</span> )
<span class="line-num">440</span>             <span class="ruby-identifier">method</span>( <span class="ruby-node">&quot;skel_#{ try_page }&quot;</span> ).<span class="ruby-identifier">call</span>( <span class="ruby-identifier">path_storage</span>, <span class="ruby-identifier">section_path</span> ) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">vars</span><span class="ruby-operator">|</span>
<span class="line-num">441</span>                 <span class="ruby-identifier">vars</span>[<span class="ruby-value">:weblog</span>] = <span class="ruby-keyword">self</span>
<span class="line-num">442</span>                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;No `page&#39; variable returned from skel_#{ try_page }.&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">vars</span>[<span class="ruby-value">:page</span>]
<span class="line-num">443</span>                 <span class="ruby-keyword">yield</span> <span class="ruby-identifier">vars</span>
<span class="line-num">444</span>             <span class="ruby-keyword">end</span>
<span class="line-num">445</span>             <span class="ruby-keyword">return</span>
<span class="line-num">446</span>         <span class="ruby-keyword">end</span>
<span class="line-num">447</span>         <span class="ruby-keyword">break</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">slice!</span>( <span class="ruby-value">-2</span> )  <span class="ruby-comment">## go up a directory</span>
<span class="line-num">448</span>     <span class="ruby-keyword">end</span>
<span class="line-num">449</span>     <span class="ruby-identifier">vars</span>[<span class="ruby-value">:weblog</span>] = <span class="ruby-keyword">self</span>
<span class="line-num">450</span>     <span class="ruby-identifier">vars</span>[<span class="ruby-value">:page</span>] = <span class="ruby-constant">Page</span>.<span class="ruby-identifier">new</span>( <span class="ruby-identifier">page_name</span> )
<span class="line-num">451</span>     <span class="ruby-identifier">vars</span>[<span class="ruby-value">:page</span>].<span class="ruby-identifier">timestamp</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
<span class="line-num">452</span>     <span class="ruby-keyword">yield</span> <span class="ruby-identifier">vars</span>
<span class="line-num">453</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-central_ext" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">central_ext</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="central_ext-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">364</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">central_ext</span>; <span class="ruby-ivar">@central_ext</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^\w*$/</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@central_ext</span>.<span class="ruby-identifier">untaint</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">default_central_ext</span>; <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-central_prefix" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">central_prefix</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="central_prefix-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">363</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">central_prefix</span>; <span class="ruby-ivar">@central_prefix</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^[\w\.]+$/</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@central_prefix</span>.<span class="ruby-identifier">untaint</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">default_central_prefix</span>; <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-commit_to_git" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">commit_to_git</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Method to commit to the local git repo and push pure happiness to the remote server named blahg (which should be of webserving character and a pleasant demeanor).</p>
          
          

          
          <div class="method-source-code" id="commit_to_git-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">661</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">commit_to_git</span>
<span class="line-num">662</span>   <span class="ruby-identifier">puts</span> <span class="ruby-string">`git add .`</span>
<span class="line-num">663</span>   <span class="ruby-identifier">puts</span> <span class="ruby-string">`git commit -a -m &quot;New poshts for the syhtt&quot;`</span>
<span class="line-num">664</span>   <span class="ruby-identifier">puts</span> <span class="ruby-string">`git push blahg master`</span>
<span class="line-num">665</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-default_central_ext" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default_central_ext</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="default_central_ext-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">355</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">default_central_ext</span>; <span class="ruby-string">&quot;html&quot;</span>; <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-default_central_prefix" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default_central_prefix</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="default_central_prefix-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">354</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">default_central_prefix</span>; <span class="ruby-string">&quot;entry&quot;</span>; <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-default_entry_class" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default_entry_class</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="default_entry_class-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">356</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">default_entry_class</span>; <span class="ruby-string">&quot;Hobix::Entry&quot;</span>; <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-default_entry_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default_entry_path</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="default_entry_path-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">350</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">default_entry_path</span>; <span class="ruby-string">&quot;entries&quot;</span>; <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-default_index_class" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default_index_class</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="default_index_class-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">357</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">default_index_class</span>; <span class="ruby-string">&quot;Hobix::IndexEntry&quot;</span>; <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-default_lib_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default_lib_path</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="default_lib_path-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">353</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">default_lib_path</span>; <span class="ruby-string">&quot;lib&quot;</span>; <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-default_output_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default_output_path</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="default_output_path-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">352</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">default_output_path</span>; <span class="ruby-string">&quot;htdocs&quot;</span>; <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-default_skel_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default_skel_path</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="default_skel_path-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">351</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">default_skel_path</span>; <span class="ruby-string">&quot;skel&quot;</span>; <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-entry_class" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">entry_class</span><span
            class="method-args">( tag = nil )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="entry_class-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">365</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">entry_class</span>( <span class="ruby-identifier">tag</span> = <span class="ruby-keyword">nil</span> )
<span class="line-num">366</span>     <span class="ruby-identifier">tag</span> = <span class="ruby-ivar">@entry_class</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^[\w:]+$/</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@entry_class</span>.<span class="ruby-identifier">untaint</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">default_entry_class</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">tag</span>
<span class="line-num">367</span>         
<span class="line-num">368</span>     <span class="ruby-identifier">found_class</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">369</span>     <span class="ruby-identifier">raise</span> <span class="ruby-identifier">@@entry_classes</span>.<span class="ruby-identifier">inspect</span>
<span class="line-num">370</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">@@entry_classes</span>
<span class="line-num">371</span> 
<span class="line-num">372</span>         <span class="ruby-identifier">found_class</span> = <span class="ruby-identifier">@@entry_classes</span>.<span class="ruby-identifier">find</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
<span class="line-num">373</span>             <span class="ruby-identifier">tag</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">split</span>( <span class="ruby-string">&#39;::&#39;</span> ).<span class="ruby-identifier">last</span>.<span class="ruby-identifier">downcase</span>
<span class="line-num">374</span>         <span class="ruby-keyword">end</span>
<span class="line-num">375</span>     <span class="ruby-keyword">end</span>
<span class="line-num">376</span> 
<span class="line-num">377</span>     <span class="ruby-keyword">begin</span>
<span class="line-num">378</span>         <span class="ruby-identifier">found_class</span> <span class="ruby-operator">||</span> <span class="ruby-constant">Hobix</span>.<span class="ruby-identifier">const_find</span>( <span class="ruby-identifier">tag</span> )
<span class="line-num">379</span>     <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NameError</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
<span class="line-num">380</span>         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NameError</span>, <span class="ruby-node">&quot;No such entry class #{ tag }&quot;</span>
<span class="line-num">381</span>     <span class="ruby-keyword">end</span>
<span class="line-num">382</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-entry_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">entry_path</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="entry_path-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">359</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">entry_path</span>; <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>( <span class="ruby-ivar">@entry_path</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">default_entry_path</span>, <span class="ruby-ivar">@path</span> ).<span class="ruby-identifier">untaint</span>; <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-expand_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">expand_path</span><span
            class="method-args">( path )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Translate paths relative to the weblahhg&#39;s URL.  This is especially important if a weblog isn&#39;t at the root directory for a domain.</p>
          
          

          
          <div class="method-source-code" id="expand_path-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">406</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">expand_path</span>( <span class="ruby-identifier">path</span> )
<span class="line-num">407</span>     <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>( <span class="ruby-identifier">path</span>.<span class="ruby-identifier">gsub</span>( <span class="ruby-regexp">/^\/+/</span>, <span class="ruby-string">&#39;&#39;</span> ), <span class="ruby-keyword">self</span>.<span class="ruby-identifier">link</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">gsub</span>( <span class="ruby-regexp">/\/*$/</span>, <span class="ruby-string">&#39;/&#39;</span> ) ).<span class="ruby-identifier">gsub</span>( <span class="ruby-regexp">/^C:/</span>, <span class="ruby-string">&#39;&#39;</span>)
<span class="line-num">408</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-facet_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">facet_for</span><span
            class="method-args">( app )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="facet_for-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">489</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">facet_for</span>( <span class="ruby-identifier">app</span> )
<span class="line-num">490</span>     <span class="ruby-identifier">facets</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">get</span> <span class="ruby-identifier">app</span> }
<span class="line-num">491</span>     <span class="ruby-constant">Hobix</span><span class="ruby-operator">::</span><span class="ruby-constant">BaseFacet</span>.<span class="ruby-identifier">not_found</span> <span class="ruby-identifier">app</span>
<span class="line-num">492</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-facets" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">facets</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns an Array of all facet plugins in use.  (There can be many.)</p>
          
          

          
          <div class="method-source-code" id="facets-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">485</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">facets</span>
<span class="line-num">486</span>     <span class="ruby-ivar">@plugins</span>.<span class="ruby-identifier">find_all</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">BaseFacet</span> }
<span class="line-num">487</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-index_class" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">index_class</span><span
            class="method-args">( tag = nil )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="index_class-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">383</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">index_class</span>( <span class="ruby-identifier">tag</span> = <span class="ruby-keyword">nil</span> )
<span class="line-num">384</span>     <span class="ruby-identifier">tag</span> = <span class="ruby-ivar">@index_class</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^[\w:]+$/</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@index_class</span>.<span class="ruby-identifier">untaint</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">default_index_class</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">tag</span>
<span class="line-num">385</span>     <span class="ruby-keyword">begin</span>
<span class="line-num">386</span>         <span class="ruby-constant">Hobix</span>.<span class="ruby-identifier">const_find</span>( <span class="ruby-identifier">tag</span> )
<span class="line-num">387</span>     <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NameError</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
<span class="line-num">388</span>         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NameError</span>, <span class="ruby-node">&quot;No such index class #{ tag }&quot;</span>
<span class="line-num">389</span>     <span class="ruby-keyword">end</span>
<span class="line-num">390</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-join_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">join_path</span><span
            class="method-args">( prefix, suffix )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="join_path-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">832</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">join_path</span>( <span class="ruby-identifier">prefix</span>, <span class="ruby-identifier">suffix</span> )
<span class="line-num">833</span>     <span class="ruby-keyword">case</span> <span class="ruby-identifier">prefix</span>
<span class="line-num">834</span>     <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;&#39;</span>, <span class="ruby-string">&#39;.&#39;</span>
<span class="line-num">835</span>         <span class="ruby-identifier">suffix</span>
<span class="line-num">836</span>     <span class="ruby-keyword">else</span>
<span class="line-num">837</span>         <span class="ruby-node">&quot;#{ prefix }/#{ suffix }&quot;</span>
<span class="line-num">838</span>     <span class="ruby-keyword">end</span>
<span class="line-num">839</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-lib_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">lib_path</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="lib_path-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">362</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">lib_path</span>; <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>( <span class="ruby-ivar">@lib_path</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">default_lib_path</span>, <span class="ruby-ivar">@path</span> ).<span class="ruby-identifier">untaint</span>; <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-link" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">link</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="link-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">392</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">link</span>
<span class="line-num">393</span>     <span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-identifier">parse</span>( <span class="ruby-ivar">@link</span>.<span class="ruby-identifier">gsub</span>( <span class="ruby-regexp">/\/$/</span>, <span class="ruby-string">&#39;&#39;</span> ) ).<span class="ruby-identifier">extend</span> <span class="ruby-constant">Hobix</span><span class="ruby-operator">::</span><span class="ruby-constant">UriStr</span>
<span class="line-num">394</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-linklist" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">linklist</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="linklist-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">396</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">linklist</span>
<span class="line-num">397</span>     <span class="ruby-keyword">if</span> <span class="ruby-ivar">@linklist</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-operator">::</span><span class="ruby-constant">Array</span>
<span class="line-num">398</span>         <span class="ruby-constant">YAML</span><span class="ruby-operator">::</span><span class="ruby-identifier">transfer</span>( <span class="ruby-string">&#39;hobix.com,2004/linklist&#39;</span>, {<span class="ruby-string">&#39;links&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-ivar">@linklist</span>} )
<span class="line-num">399</span>     <span class="ruby-keyword">else</span>
<span class="line-num">400</span>        <span class="ruby-ivar">@linklist</span>
<span class="line-num">401</span>     <span class="ruby-keyword">end</span>
<span class="line-num">402</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-load_and_validate_entry" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">load_and_validate_entry</span><span
            class="method-args">( entry_id )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Loads an entry from <code>storage</code>, first validating that the author is listed in the weblog config.</p>
          
          

          
          <div class="method-source-code" id="load_and_validate_entry-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">845</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">load_and_validate_entry</span>( <span class="ruby-identifier">entry_id</span> )
<span class="line-num">846</span>     <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">storage</span>.<span class="ruby-identifier">load_entry</span>( <span class="ruby-identifier">entry_id</span> )
<span class="line-num">847</span>     <span class="ruby-keyword">unless</span> <span class="ruby-identifier">authors</span>.<span class="ruby-identifier">has_key?</span>( <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">author</span> )
<span class="line-num">848</span>         <span class="ruby-identifier">raise</span> <span class="ruby-constant">AuthorNotFound</span>, <span class="ruby-node">&quot;Invalid author &#39;#{ entry.author }&#39; found in entry #{ entry_id }&quot;</span>
<span class="line-num">849</span>     <span class="ruby-keyword">end</span>
<span class="line-num">850</span>     <span class="ruby-identifier">entry</span>
<span class="line-num">851</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-method_missing" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">method_missing</span><span
            class="method-args">( methId, *args )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>For convenience, storage queries can be made through the <a href="Weblog.html"><code>Weblog</code></a> class.  Queries will return the full <a href="Entry.html"><code>Entry</code></a> data, though, so it&#39;s best to use this only when you&#39;re scripting and need data quick.</p>
          
          

          
          <div class="method-source-code" id="method_missing-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">861</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">method_missing</span>( <span class="ruby-identifier">methId</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span> )
<span class="line-num">862</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">storage</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-identifier">methId</span>
<span class="line-num">863</span>         <span class="ruby-identifier">storage</span>.<span class="ruby-identifier">method</span>( <span class="ruby-identifier">methId</span> ).<span class="ruby-identifier">call</span>( <span class="ruby-operator">*</span><span class="ruby-identifier">args</span> ).<span class="ruby-identifier">collect</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
<span class="line-num">864</span>             <span class="ruby-identifier">load_and_validate_entry</span>( <span class="ruby-identifier">e</span>.<span class="ruby-identifier">id</span> )
<span class="line-num">865</span>         <span class="ruby-keyword">end</span>
<span class="line-num">866</span>     <span class="ruby-keyword">end</span>
<span class="line-num">867</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-output_entry_map" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">output_entry_map</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Built from the map of output destinations described by <code>output_map</code>, this map pairs entry IDs against their canonical destinations.  The @central_prefix and @central_ext variables determine what output is canonical.</p>
          
          

          
          <div class="method-source-code" id="output_entry_map-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">552</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">output_entry_map</span>
<span class="line-num">553</span>     <span class="ruby-identifier">output_map</span>
<span class="line-num">554</span>     <span class="ruby-ivar">@output_entry_map</span>
<span class="line-num">555</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-output_map" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">output_map</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Reads <code>skel_path</code> for templates and builds a hash of all the various output files which will be generated.  This method will cache the <a href="Weblog.html#method-i-output_map"><code>output_map</code></a> once. Subsequent calls to <code>output_map</code> will quickly return the cached hash.  To reset the cache, use <code>reset_output_map</code>.</p>
          
          

          
          <div class="method-source-code" id="output_map-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">501</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">output_map</span>
<span class="line-num">502</span>     <span class="ruby-ivar">@output_map</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">nil</span>
<span class="line-num">503</span>     <span class="ruby-keyword">return</span> <span class="ruby-ivar">@output_map</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@output_map</span>
<span class="line-num">504</span>     <span class="ruby-identifier">path_watch</span> = {}
<span class="line-num">505</span>     <span class="ruby-ivar">@output_entry_map</span> = {}
<span class="line-num">506</span>     <span class="ruby-constant">Find</span><span class="ruby-operator">::</span><span class="ruby-identifier">find</span>( <span class="ruby-identifier">skel_path</span> ) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>
<span class="line-num">507</span>         <span class="ruby-identifier">path</span>.<span class="ruby-identifier">untaint</span>
<span class="line-num">508</span>         <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">path</span>)[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value">?.</span>
<span class="line-num">509</span>             <span class="ruby-constant">Find</span>.<span class="ruby-identifier">prune</span> 
<span class="line-num">510</span>         <span class="ruby-keyword">elsif</span> <span class="ruby-keyword">not</span> <span class="ruby-constant">FileTest</span>.<span class="ruby-identifier">directory?</span> <span class="ruby-identifier">path</span>
<span class="line-num">511</span>             <span class="ruby-identifier">tpl_path</span> = <span class="ruby-identifier">path</span>.<span class="ruby-identifier">gsub</span>( <span class="ruby-regexp">/^#{ Regexp::quote( skel_path ) }\/?/</span>, <span class="ruby-string">&#39;&#39;</span> )
<span class="line-num">512</span>             <span class="ruby-identifier">output</span> = <span class="ruby-identifier">outputs</span>.<span class="ruby-identifier">detect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">tpl_path</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\.#{ p.extension }$/</span>; <span class="ruby-identifier">tpl_path</span> = <span class="ruby-node">$`</span>; <span class="ruby-keyword">end</span> }
<span class="line-num">513</span>             <span class="ruby-keyword">if</span> <span class="ruby-identifier">output</span>
<span class="line-num">514</span>                 <span class="ruby-comment">## Figure out template extension and output filename</span>
<span class="line-num">515</span>                 <span class="ruby-identifier">page_name</span>, <span class="ruby-identifier">tpl_ext</span> = <span class="ruby-identifier">tpl_path</span>.<span class="ruby-identifier">dup</span>, <span class="ruby-string">&#39;&#39;</span>
<span class="line-num">516</span>                 <span class="ruby-keyword">while</span> <span class="ruby-identifier">page_name</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\.\w+$/</span>; <span class="ruby-identifier">page_name</span> = <span class="ruby-node">$`</span>; <span class="ruby-identifier">tpl_ext</span> = <span class="ruby-node">$&amp;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">tpl_ext</span>; <span class="ruby-keyword">end</span>
<span class="line-num">517</span>                 <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">tpl_ext</span>.<span class="ruby-identifier">empty?</span>
<span class="line-num">518</span>                 <span class="ruby-comment">## Build the output pages</span>
<span class="line-num">519</span>                 <span class="ruby-identifier">build_pages</span>( <span class="ruby-identifier">page_name</span> ) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">vars</span><span class="ruby-operator">|</span>
<span class="line-num">520</span>                     <span class="ruby-comment">## Extension and Path</span>
<span class="line-num">521</span>                     <span class="ruby-identifier">vars</span>[<span class="ruby-value">:page</span>].<span class="ruby-identifier">add_ext</span>( <span class="ruby-identifier">tpl_ext</span> )
<span class="line-num">522</span>                     <span class="ruby-identifier">vars</span>[<span class="ruby-value">:template</span>] = <span class="ruby-identifier">path</span>
<span class="line-num">523</span>                     <span class="ruby-identifier">vars</span>[<span class="ruby-value">:output</span>] = <span class="ruby-identifier">output</span>
<span class="line-num">524</span>                     <span class="ruby-identifier">eid</span> = ( <span class="ruby-identifier">vars</span>[<span class="ruby-value">:entry</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">vars</span>[<span class="ruby-value">:entry</span>].<span class="ruby-identifier">id</span> ) <span class="ruby-operator">||</span> <span class="ruby-identifier">page_name</span>
<span class="line-num">525</span>                     <span class="ruby-keyword">if</span> <span class="ruby-keyword">not</span> <span class="ruby-ivar">@output_entry_map</span>[ <span class="ruby-identifier">eid</span> ]
<span class="line-num">526</span>                         <span class="ruby-ivar">@output_entry_map</span>[ <span class="ruby-identifier">eid</span> ] = <span class="ruby-identifier">vars</span>
<span class="line-num">527</span>                     <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">tpl_ext</span>.<span class="ruby-identifier">split</span>( <span class="ruby-string">&#39;.&#39;</span> )[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">central_ext</span>
<span class="line-num">528</span>                         <span class="ruby-ivar">@output_entry_map</span>[ <span class="ruby-identifier">eid</span> ] = <span class="ruby-identifier">vars</span>
<span class="line-num">529</span>                     <span class="ruby-keyword">end</span>
<span class="line-num">530</span> 
<span class="line-num">531</span>                     <span class="ruby-comment">## If output by a deeper page, skip</span>
<span class="line-num">532</span>                     <span class="ruby-identifier">pub_name</span>, = <span class="ruby-identifier">path_watch</span>[<span class="ruby-identifier">vars</span>[<span class="ruby-value">:page</span>].<span class="ruby-identifier">link</span>]
<span class="line-num">533</span>                     <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">pub_name</span> <span class="ruby-keyword">and</span> <span class="ruby-operator">!</span>( <span class="ruby-identifier">vars</span>[<span class="ruby-value">:page</span>].<span class="ruby-identifier">link</span>.<span class="ruby-identifier">index</span>( <span class="ruby-identifier">page_name</span> ) <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-keyword">and</span>
<span class="line-num">534</span>                                           <span class="ruby-identifier">page_name</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">pub_name</span>.<span class="ruby-identifier">length</span> )
<span class="line-num">535</span> 
<span class="line-num">536</span>                     <span class="ruby-identifier">path_watch</span>[<span class="ruby-identifier">vars</span>[<span class="ruby-value">:page</span>].<span class="ruby-identifier">link</span>] = [<span class="ruby-identifier">page_name</span>, <span class="ruby-identifier">vars</span>]
<span class="line-num">537</span>                 <span class="ruby-keyword">end</span>
<span class="line-num">538</span>             <span class="ruby-keyword">end</span>
<span class="line-num">539</span>         <span class="ruby-keyword">end</span>
<span class="line-num">540</span>     <span class="ruby-keyword">end</span>
<span class="line-num">541</span>     <span class="ruby-ivar">@output_map</span> = {}
<span class="line-num">542</span>     <span class="ruby-identifier">path_watch</span>.<span class="ruby-identifier">each_value</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">page_name</span>, <span class="ruby-identifier">vars</span><span class="ruby-operator">|</span>
<span class="line-num">543</span>         <span class="ruby-ivar">@output_map</span>[<span class="ruby-identifier">page_name</span>] <span class="ruby-operator">||=</span> []
<span class="line-num">544</span>         <span class="ruby-ivar">@output_map</span>[<span class="ruby-identifier">page_name</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">vars</span>
<span class="line-num">545</span>     <span class="ruby-keyword">end</span>
<span class="line-num">546</span>     <span class="ruby-ivar">@output_map</span>
<span class="line-num">547</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-output_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">output_path</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="output_path-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">361</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">output_path</span>; <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>( <span class="ruby-ivar">@output_path</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">default_output_path</span>, <span class="ruby-ivar">@path</span> ).<span class="ruby-identifier">untaint</span>; <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-outputs" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">outputs</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns an Array of all output plugins in use.  (There can be many.)</p>
          
          

          
          <div class="method-source-code" id="outputs-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">473</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">outputs</span>
<span class="line-num">474</span>     <span class="ruby-ivar">@plugins</span>.<span class="ruby-identifier">find_all</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">BaseOutput</span> }
<span class="line-num">475</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-p_publish" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">p_publish</span><span
            class="method-args">( obj )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Prints publication information the screen.  Override this if you want to suppress output or change the display.</p>
          
          

          
          <div class="method-source-code" id="p_publish-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">871</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">p_publish</span>( <span class="ruby-identifier">obj</span> )
<span class="line-num">872</span>     <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;## Page: #{ obj.link }, updated #{ obj.updated }&quot;</span>
<span class="line-num">873</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-publishers" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">publishers</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns an Array of all publisher plugins in use.  (There can be many.)</p>
          
          

          
          <div class="method-source-code" id="publishers-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">479</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">publishers</span>
<span class="line-num">480</span>     <span class="ruby-ivar">@plugins</span>.<span class="ruby-identifier">find_all</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">BasePublish</span> }
<span class="line-num">481</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-regenerate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">regenerate</span><span
            class="method-args">( how = nil )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Regenerates the weblog, processing templates in <code>skel_path</code> with the data found in <code>entry_path</code>, storing output in <code>output_path</code>.</p>

<p>The <em>how</em> parameter dictates how this is done, Currently, if <em>how</em> is nil the weblog is completely regen&#39;d. If it is :update, the weblog is only upgen&#39;d.</p>

<h2 id="method-i-regenerate-label-How+Updates+Work">How Updates Work<span><a href="#method-i-regenerate-label-How+Updates+Work">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>It&#39;s very important to know how updates work, especially if you are writing custom skel methods or devious new kinds of templates.  When performing an update, this method will skip pages if the following conditions are met:</p>
<ol><li>
<p>The <a href="Page.html"><code>Page</code></a> object for a given output page must have its <code>updated</code> timestamp set.</p>
</li><li>
<p>The output file pointed to by the <a href="Page.html"><code>Page</code></a> object must already exist.</p>
</li><li>
<p>The <code>updated</code> timestamp must be older than than the modification time of the output file.</p>
</li><li>
<p>The modification time of the input template must be older  than than the modification time of the output file.</p>
</li></ol>

<p>To ensure that your custom methods and templates are qualifying to be skipped on an upgen, be sure to set the <code>updated</code> timestamp of the <a href="Page.html"><code>Page</code></a> object to the latest date of the content&#39;s modification.</p>
          
          

          
          <div class="method-source-code" id="regenerate-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">585</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">regenerate</span>( <span class="ruby-identifier">how</span> = <span class="ruby-keyword">nil</span> )
<span class="line-num">586</span>     <span class="ruby-identifier">retouch</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">how</span>
<span class="line-num">587</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-reset_output_map" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reset_output_map</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Clears the hash used to cache the results of <code>output_map</code>.</p>
          
          

          
          <div class="method-source-code" id="reset_output_map-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">495</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset_output_map</span>; <span class="ruby-ivar">@output_map</span> = <span class="ruby-keyword">nil</span>; <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-retouch" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">retouch</span><span
            class="method-args">( only_path = nil, how = nil )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="retouch-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">588</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">retouch</span>( <span class="ruby-identifier">only_path</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">how</span> = <span class="ruby-keyword">nil</span> )
<span class="line-num">589</span>     <span class="ruby-identifier">published</span> = {}
<span class="line-num">590</span>     <span class="ruby-identifier">published_types</span> = []
<span class="line-num">591</span>     <span class="ruby-identifier">output_map</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">page_name</span>, <span class="ruby-identifier">outputs</span><span class="ruby-operator">|</span>
<span class="line-num">592</span>         <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;[Building #{ page_name } pages]&quot;</span>
<span class="line-num">593</span>         <span class="ruby-identifier">outputs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">vars</span><span class="ruby-operator">|</span>
<span class="line-num">594</span>             <span class="ruby-identifier">full_out_path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>( <span class="ruby-identifier">output_path</span>, <span class="ruby-identifier">vars</span>[<span class="ruby-value">:page</span>].<span class="ruby-identifier">link</span>.<span class="ruby-identifier">split</span>( <span class="ruby-string">&#39;/&#39;</span> ) )
<span class="line-num">595</span>             <span class="ruby-comment">## If retouching, skip pages outside of path</span>
<span class="line-num">596</span>             <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">only_path</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">vars</span>[<span class="ruby-value">:page</span>].<span class="ruby-identifier">link</span>.<span class="ruby-identifier">index</span>( <span class="ruby-string">&quot;/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">only_path</span> ) <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
<span class="line-num">597</span> 
<span class="line-num">598</span>             <span class="ruby-comment">## If updating, skip any that are unchanged</span>
<span class="line-num">599</span>             <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">how</span> <span class="ruby-operator">==</span> <span class="ruby-value">:update</span> <span class="ruby-keyword">and</span> 
<span class="line-num">600</span>                     <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>( <span class="ruby-identifier">full_out_path</span> ) <span class="ruby-keyword">and</span>
<span class="line-num">601</span>                     <span class="ruby-constant">File</span>.<span class="ruby-identifier">mtime</span>( <span class="ruby-identifier">vars</span>[<span class="ruby-value">:template</span>] ) <span class="ruby-operator">&lt;</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">mtime</span>( <span class="ruby-identifier">full_out_path</span> ) <span class="ruby-keyword">and</span>
<span class="line-num">602</span>                     ( <span class="ruby-identifier">vars</span>[<span class="ruby-value">:page</span>].<span class="ruby-identifier">updated</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword">or</span> 
<span class="line-num">603</span>                       <span class="ruby-identifier">vars</span>[<span class="ruby-value">:page</span>].<span class="ruby-identifier">updated</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">mtime</span>( <span class="ruby-identifier">full_out_path</span> ) )
<span class="line-num">604</span> 
<span class="line-num">605</span>             <span class="ruby-identifier">p_publish</span> <span class="ruby-identifier">vars</span>[<span class="ruby-value">:page</span>]
<span class="line-num">606</span>             <span class="ruby-identifier">vars</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">var_name</span><span class="ruby-operator">|</span>
<span class="line-num">607</span>                 <span class="ruby-keyword">case</span> <span class="ruby-identifier">var_name</span>.<span class="ruby-identifier">to_s</span>
<span class="line-num">608</span>                 <span class="ruby-keyword">when</span> <span class="ruby-regexp">/entry$/</span>
<span class="line-num">609</span>                     <span class="ruby-keyword">unless</span> <span class="ruby-identifier">vars</span>[<span class="ruby-value">:no_load</span>]
<span class="line-num">610</span>                         <span class="ruby-identifier">vars</span>[<span class="ruby-identifier">var_name</span>] = <span class="ruby-identifier">load_and_validate_entry</span>( <span class="ruby-identifier">vars</span>[<span class="ruby-identifier">var_name</span>].<span class="ruby-identifier">id</span> )
<span class="line-num">611</span>                     <span class="ruby-keyword">end</span>
<span class="line-num">612</span>                 <span class="ruby-keyword">when</span> <span class="ruby-regexp">/entries$/</span>
<span class="line-num">613</span>                     <span class="ruby-keyword">unless</span> <span class="ruby-identifier">vars</span>[<span class="ruby-value">:no_load</span>]
<span class="line-num">614</span>                         <span class="ruby-identifier">vars</span>[<span class="ruby-identifier">var_name</span>].<span class="ruby-identifier">collect!</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
<span class="line-num">615</span>                             <span class="ruby-identifier">load_and_validate_entry</span>( <span class="ruby-identifier">e</span>.<span class="ruby-identifier">id</span> )
<span class="line-num">616</span>                         <span class="ruby-keyword">end</span>
<span class="line-num">617</span>                     <span class="ruby-keyword">end</span>
<span class="line-num">618</span>                     <span class="ruby-identifier">vars</span>[<span class="ruby-identifier">var_name</span>].<span class="ruby-identifier">extend</span> <span class="ruby-constant">Hobix</span><span class="ruby-operator">::</span><span class="ruby-constant">EntryEnum</span>
<span class="line-num">619</span>                 <span class="ruby-keyword">end</span>
<span class="line-num">620</span>             <span class="ruby-keyword">end</span>
<span class="line-num">621</span> 
<span class="line-num">622</span>             <span class="ruby-comment">## Publish the page</span>
<span class="line-num">623</span>             <span class="ruby-identifier">vars</span> = <span class="ruby-identifier">vars</span>.<span class="ruby-identifier">dup</span>
<span class="line-num">624</span>             <span class="ruby-identifier">output</span> = <span class="ruby-identifier">vars</span>.<span class="ruby-identifier">delete</span>( <span class="ruby-value">:output</span> )
<span class="line-num">625</span>             <span class="ruby-identifier">template</span> = <span class="ruby-identifier">vars</span>.<span class="ruby-identifier">delete</span>( <span class="ruby-value">:template</span> )
<span class="line-num">626</span>             <span class="ruby-identifier">txt</span> = <span class="ruby-identifier">output</span>.<span class="ruby-identifier">load</span>( <span class="ruby-identifier">template</span>, <span class="ruby-identifier">vars</span> )
<span class="line-num">627</span>             <span class="ruby-comment">## A plugin perhaps needs to change the output page name</span>
<span class="line-num">628</span>             <span class="ruby-identifier">full_out_path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>( <span class="ruby-identifier">output_path</span>, <span class="ruby-identifier">vars</span>[<span class="ruby-value">:page</span>].<span class="ruby-identifier">link</span>.<span class="ruby-identifier">split</span>( <span class="ruby-string">&#39;/&#39;</span> ) )
<span class="line-num">629</span>             <span class="ruby-identifier">saved_umask</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">umask</span>( <span class="ruby-value">0002</span> ) <span class="ruby-keyword">rescue</span> <span class="ruby-keyword">nil</span>
<span class="line-num">630</span>             <span class="ruby-keyword">begin</span>
<span class="line-num">631</span>               <span class="ruby-constant">File</span>.<span class="ruby-identifier">makedirs</span>( <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>( <span class="ruby-identifier">full_out_path</span> ) )
<span class="line-num">632</span>               <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>( <span class="ruby-identifier">full_out_path</span>, <span class="ruby-string">&#39;w&#39;</span> ) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> 
<span class="line-num">633</span>                   <span class="ruby-identifier">f</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">txt</span>
<span class="line-num">634</span>               <span class="ruby-keyword">end</span>
<span class="line-num">635</span>             <span class="ruby-keyword">ensure</span>
<span class="line-num">636</span>               <span class="ruby-constant">File</span>.<span class="ruby-identifier">umask</span>( <span class="ruby-identifier">saved_umask</span> ) <span class="ruby-keyword">rescue</span> <span class="ruby-keyword">nil</span>
<span class="line-num">637</span>             <span class="ruby-keyword">end</span>
<span class="line-num">638</span>             <span class="ruby-identifier">published</span>[<span class="ruby-identifier">vars</span>[<span class="ruby-value">:page</span>].<span class="ruby-identifier">link</span>] = <span class="ruby-identifier">vars</span>[<span class="ruby-value">:page</span>]
<span class="line-num">639</span>             <span class="ruby-identifier">published_types</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">page_name</span>
<span class="line-num">640</span>         <span class="ruby-keyword">end</span>
<span class="line-num">641</span>     <span class="ruby-keyword">end</span>
<span class="line-num">642</span>     <span class="ruby-identifier">published_types</span>.<span class="ruby-identifier">uniq!</span>
<span class="line-num">643</span>     <span class="ruby-identifier">publishers</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span>
<span class="line-num">644</span>         <span class="ruby-keyword">if</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:watch</span>
<span class="line-num">645</span>             <span class="ruby-keyword">if</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">watch</span> <span class="ruby-operator">&amp;</span> <span class="ruby-identifier">published_types</span> <span class="ruby-operator">!=</span> []
<span class="line-num">646</span>                 <span class="ruby-identifier">p</span>.<span class="ruby-identifier">publish</span>( <span class="ruby-identifier">published</span> )
<span class="line-num">647</span>             <span class="ruby-keyword">end</span>
<span class="line-num">648</span>         <span class="ruby-keyword">else</span>
<span class="line-num">649</span>             <span class="ruby-identifier">p</span>.<span class="ruby-identifier">publish</span>( <span class="ruby-identifier">published</span> )
<span class="line-num">650</span>         <span class="ruby-keyword">end</span>
<span class="line-num">651</span>     <span class="ruby-keyword">end</span>
<span class="line-num">652</span> 
<span class="line-num">653</span>     <span class="ruby-identifier">commit_to_git</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@git</span>
<span class="line-num">654</span> 
<span class="line-num">655</span>     <span class="ruby-identifier">reset_output_map</span>
<span class="line-num">656</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-save" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">save</span><span
            class="method-args">( file = @hobix_yaml )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Save the weblog configuration to its hobix.yaml (or optionally provide a path where you would like to save.)</p>
          
          

          
          <div class="method-source-code" id="save-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">420</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">save</span>( <span class="ruby-identifier">file</span> = <span class="ruby-ivar">@hobix_yaml</span> )
<span class="line-num">421</span>     <span class="ruby-keyword">unless</span> <span class="ruby-identifier">file</span>
<span class="line-num">422</span>         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;Missing argument: path to save configuration (0 of 1)&quot;</span>
<span class="line-num">423</span>     <span class="ruby-keyword">end</span>
<span class="line-num">424</span>     <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-identifier">open</span>( <span class="ruby-identifier">file</span>, <span class="ruby-string">&#39;w&#39;</span> ) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
<span class="line-num">425</span>         <span class="ruby-constant">YAML</span><span class="ruby-operator">::</span><span class="ruby-identifier">dump</span>( <span class="ruby-keyword">self</span>, <span class="ruby-identifier">f</span> )
<span class="line-num">426</span>     <span class="ruby-keyword">end</span>
<span class="line-num">427</span>     <span class="ruby-keyword">self</span>
<span class="line-num">428</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-sections" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">sections</span><span
            class="method-args">( opts = nil )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Receive a Hash pairing all section ids with the options for that section.</p>
          
          

          
          <div class="method-source-code" id="sections-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">786</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sections</span>( <span class="ruby-identifier">opts</span> = <span class="ruby-keyword">nil</span> )
<span class="line-num">787</span>     <span class="ruby-identifier">sections</span> = <span class="ruby-constant">Marshal</span><span class="ruby-operator">::</span><span class="ruby-identifier">load</span>( <span class="ruby-constant">Marshal</span><span class="ruby-operator">::</span><span class="ruby-identifier">dump</span>( <span class="ruby-ivar">@sections</span> ) )
<span class="line-num">788</span>     <span class="ruby-identifier">observes</span> = <span class="ruby-operator">!</span><span class="ruby-identifier">sections</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">detect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-identifier">s</span>[<span class="ruby-string">&#39;observe&#39;</span>] }
<span class="line-num">789</span>     <span class="ruby-identifier">storage</span>.<span class="ruby-identifier">sections</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
<span class="line-num">790</span>         <span class="ruby-identifier">sections</span>[<span class="ruby-identifier">s</span>] <span class="ruby-operator">||=</span> {}
<span class="line-num">791</span>         <span class="ruby-identifier">sections</span>[<span class="ruby-identifier">s</span>][<span class="ruby-string">&#39;observe&#39;</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">sections</span>[<span class="ruby-identifier">s</span>].<span class="ruby-identifier">has_key?</span>( <span class="ruby-string">&#39;ignore&#39;</span> ) <span class="ruby-operator">?</span> <span class="ruby-operator">!</span><span class="ruby-identifier">sections</span>[<span class="ruby-identifier">s</span>][<span class="ruby-string">&#39;ignore&#39;</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">observes</span>
<span class="line-num">792</span>         <span class="ruby-identifier">sections</span>[<span class="ruby-identifier">s</span>][<span class="ruby-string">&#39;ignore&#39;</span>] <span class="ruby-operator">||=</span> <span class="ruby-operator">!</span><span class="ruby-identifier">sections</span>[<span class="ruby-identifier">s</span>][<span class="ruby-string">&#39;observe&#39;</span>]
<span class="line-num">793</span>     <span class="ruby-keyword">end</span>
<span class="line-num">794</span>     <span class="ruby-identifier">sections</span>
<span class="line-num">795</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-sections_ignored" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">sections_ignored</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns an Array of entry paths ignored by general querying. Storage plugins must withhold these entries from queries, unless the :all =&gt; true setting is passed to the query.</p>
          
          

          
          <div class="method-source-code" id="sections_ignored-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">811</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sections_ignored</span>
<span class="line-num">812</span>     <span class="ruby-identifier">sections</span>.<span class="ruby-identifier">collect</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
<span class="line-num">813</span>         <span class="ruby-identifier">k</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>[<span class="ruby-string">&#39;ignore&#39;</span>]
<span class="line-num">814</span>     <span class="ruby-keyword">end</span>.<span class="ruby-identifier">compact</span>
<span class="line-num">815</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-sections_sorts" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">sections_sorts</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a hash of special sorting cases.  Key is the entry path, value is the sorting method.  Storage plugins must honor these default sorts.</p>
          
          

          
          <div class="method-source-code" id="sections_sorts-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">800</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sections_sorts</span>
<span class="line-num">801</span>     <span class="ruby-ivar">@sections</span>.<span class="ruby-identifier">inject</span>( {} ) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">sorts</span>, <span class="ruby-identifier">set</span><span class="ruby-operator">|</span>
<span class="line-num">802</span>         <span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span> = <span class="ruby-identifier">set</span>
<span class="line-num">803</span>         <span class="ruby-identifier">sorts</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">v</span>[<span class="ruby-string">&#39;sort_by&#39;</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>[<span class="ruby-string">&#39;sort_by&#39;</span>]
<span class="line-num">804</span>         <span class="ruby-identifier">sorts</span>
<span class="line-num">805</span>     <span class="ruby-keyword">end</span>
<span class="line-num">806</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-setup" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">setup</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Sets up a weblog.  Should only be run once (which <a href="../Hobix.html"><code>Hobix</code></a> performs automatically upon blog creation).</p>
          
          

          
          <div class="method-source-code" id="setup-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">457</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">setup</span>
<span class="line-num">458</span>     <span class="ruby-ivar">@plugins</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span>
<span class="line-num">459</span>         <span class="ruby-keyword">if</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:setup</span>
<span class="line-num">460</span>             <span class="ruby-identifier">p</span>.<span class="ruby-identifier">setup</span>
<span class="line-num">461</span>         <span class="ruby-keyword">end</span>
<span class="line-num">462</span>     <span class="ruby-keyword">end</span>
<span class="line-num">463</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-skel_daily" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">skel_daily</span><span
            class="method-args">( path_storage, section_path ) { |:page =&gt; page, :entries =&gt; curr| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Handler for templates with `daily&#39; prefix.  These templates will receive a list of entries for each day that has at least one entry created in its time period.  This handler requests daily pages to be output as `/%Y/%m/%d.ext&#39;.</p>
          
          

          
          <div class="method-source-code" id="skel_daily-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">683</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skel_daily</span>( <span class="ruby-identifier">path_storage</span>, <span class="ruby-identifier">section_path</span> )
<span class="line-num">684</span>     <span class="ruby-identifier">entry_range</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">find</span>
<span class="line-num">685</span>     <span class="ruby-identifier">first_time</span>, <span class="ruby-identifier">last_time</span> = <span class="ruby-identifier">entry_range</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">created</span>, <span class="ruby-identifier">entry_range</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">created</span>
<span class="line-num">686</span>     <span class="ruby-identifier">start</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">mktime</span>( <span class="ruby-identifier">first_time</span>.<span class="ruby-identifier">year</span>, <span class="ruby-identifier">first_time</span>.<span class="ruby-identifier">month</span>, <span class="ruby-identifier">first_time</span>.<span class="ruby-identifier">day</span>, <span class="ruby-value">0</span>, <span class="ruby-value">0</span>, <span class="ruby-value">0</span> ) <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
<span class="line-num">687</span>     <span class="ruby-identifier">stop</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">mktime</span>( <span class="ruby-identifier">last_time</span>.<span class="ruby-identifier">year</span>, <span class="ruby-identifier">last_time</span>.<span class="ruby-identifier">month</span>, <span class="ruby-identifier">last_time</span>.<span class="ruby-identifier">day</span>, <span class="ruby-value">23</span>, <span class="ruby-value">59</span>, <span class="ruby-value">59</span> )
<span class="line-num">688</span>     <span class="ruby-identifier">days</span> = []
<span class="line-num">689</span>     <span class="ruby-identifier">one_day</span> = <span class="ruby-value">24</span> <span class="ruby-operator">*</span> <span class="ruby-value">60</span> <span class="ruby-operator">*</span> <span class="ruby-value">60</span>
<span class="line-num">690</span>     <span class="ruby-keyword">until</span> <span class="ruby-identifier">start</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">stop</span>
<span class="line-num">691</span>         <span class="ruby-identifier">day_entries</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">within</span>( <span class="ruby-identifier">start</span>, <span class="ruby-identifier">start</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">one_day</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span> )
<span class="line-num">692</span>         <span class="ruby-identifier">days</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">day_entries</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">created</span>, <span class="ruby-identifier">day_entries</span>] <span class="ruby-keyword">unless</span> <span class="ruby-identifier">day_entries</span>.<span class="ruby-identifier">empty?</span>
<span class="line-num">693</span>         <span class="ruby-identifier">start</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">one_day</span>
<span class="line-num">694</span>     <span class="ruby-keyword">end</span>
<span class="line-num">695</span>     <span class="ruby-identifier">days</span>.<span class="ruby-identifier">extend</span> <span class="ruby-constant">Hobix</span><span class="ruby-operator">::</span><span class="ruby-constant">Enumerable</span>
<span class="line-num">696</span>     <span class="ruby-identifier">days</span>.<span class="ruby-identifier">each_with_neighbors</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">prev</span>, <span class="ruby-identifier">curr</span>, <span class="ruby-identifier">nextd</span><span class="ruby-operator">|</span> 
<span class="line-num">697</span>         <span class="ruby-identifier">page</span> = <span class="ruby-constant">Page</span>.<span class="ruby-identifier">new</span>( <span class="ruby-identifier">curr</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">strftime</span>( <span class="ruby-string">&quot;%Y/%m/%d&quot;</span> ), <span class="ruby-identifier">section_path</span> )
<span class="line-num">698</span>         <span class="ruby-identifier">page</span>.<span class="ruby-identifier">prev</span> = <span class="ruby-identifier">prev</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">strftime</span>( <span class="ruby-string">&quot;%Y/%m/%d&quot;</span> ) <span class="ruby-keyword">if</span> <span class="ruby-identifier">prev</span>
<span class="line-num">699</span>         <span class="ruby-identifier">page</span>.<span class="ruby-identifier">next</span> = <span class="ruby-identifier">nextd</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">strftime</span>( <span class="ruby-string">&quot;%Y/%m/%d&quot;</span> ) <span class="ruby-keyword">if</span> <span class="ruby-identifier">nextd</span>
<span class="line-num">700</span>         <span class="ruby-identifier">page</span>.<span class="ruby-identifier">timestamp</span> = <span class="ruby-identifier">curr</span>[<span class="ruby-value">0</span>]
<span class="line-num">701</span>         <span class="ruby-identifier">page</span>.<span class="ruby-identifier">updated</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">last_updated</span>( <span class="ruby-identifier">curr</span>[<span class="ruby-value">1</span>] )
<span class="line-num">702</span>         <span class="ruby-keyword">yield</span> <span class="ruby-value">:page</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">page</span>, <span class="ruby-value">:entries</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">curr</span>[<span class="ruby-value">1</span>]
<span class="line-num">703</span>     <span class="ruby-keyword">end</span>
<span class="line-num">704</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-skel_entry" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">skel_entry</span><span
            class="method-args">( path_storage, section_path ) { |:page =&gt; page, :entry =&gt; entry| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Handler for templates with `entry&#39; prefix.  These templates will receive one entry for each entry in the weblog.  The handler requests entry pages to be output as `/shortName.ext&#39;.</p>
          
          

          
          <div class="method-source-code" id="skel_entry-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">749</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skel_entry</span>( <span class="ruby-identifier">path_storage</span>, <span class="ruby-identifier">section_path</span> )
<span class="line-num">750</span>     <span class="ruby-identifier">all_entries</span> = [<span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">find</span>]
<span class="line-num">751</span>     <span class="ruby-identifier">all_entries</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">sections_ignored</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ign</span><span class="ruby-operator">|</span> <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">find</span>( <span class="ruby-value">:all</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-keyword">true</span>, <span class="ruby-value">:inpath</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">ign</span> ) }
<span class="line-num">752</span>     <span class="ruby-identifier">all_entries</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entry_set</span><span class="ruby-operator">|</span>
<span class="line-num">753</span>         <span class="ruby-identifier">entry_set</span>.<span class="ruby-identifier">extend</span> <span class="ruby-constant">Hobix</span><span class="ruby-operator">::</span><span class="ruby-constant">Enumerable</span>
<span class="line-num">754</span>         <span class="ruby-identifier">entry_set</span>.<span class="ruby-identifier">each_with_neighbors</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">nexte</span>, <span class="ruby-identifier">entry</span>, <span class="ruby-identifier">prev</span><span class="ruby-operator">|</span>
<span class="line-num">755</span>             <span class="ruby-identifier">page</span> = <span class="ruby-constant">Page</span>.<span class="ruby-identifier">new</span>( <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">id</span> )
<span class="line-num">756</span>             <span class="ruby-identifier">page</span>.<span class="ruby-identifier">prev</span> = <span class="ruby-identifier">prev</span>.<span class="ruby-identifier">id</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">prev</span>
<span class="line-num">757</span>             <span class="ruby-identifier">page</span>.<span class="ruby-identifier">next</span> = <span class="ruby-identifier">nexte</span>.<span class="ruby-identifier">id</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">nexte</span>
<span class="line-num">758</span>             <span class="ruby-identifier">page</span>.<span class="ruby-identifier">timestamp</span> = <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">created</span>
<span class="line-num">759</span>             <span class="ruby-identifier">page</span>.<span class="ruby-identifier">updated</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">updated</span>( <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">id</span> )
<span class="line-num">760</span>             <span class="ruby-keyword">yield</span> <span class="ruby-value">:page</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">page</span>, <span class="ruby-value">:entry</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">entry</span>
<span class="line-num">761</span>         <span class="ruby-keyword">end</span>
<span class="line-num">762</span>     <span class="ruby-keyword">end</span>
<span class="line-num">763</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-skel_index" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">skel_index</span><span
            class="method-args">( path_storage, section_path ) { |:page =&gt; page, :entries =&gt; index_entries| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Handler for templates with `index&#39; prefix.  These templates will receive entries loaded by +Hobix::BaseStorage#lastn+.  Only one index page is requested by this handler.</p>
          
          

          
          <div class="method-source-code" id="skel_index-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">670</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skel_index</span>( <span class="ruby-identifier">path_storage</span>, <span class="ruby-identifier">section_path</span> )
<span class="line-num">671</span>     <span class="ruby-identifier">index_entries</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">lastn</span>( <span class="ruby-ivar">@lastn</span> )
<span class="line-num">672</span>     <span class="ruby-identifier">page</span> = <span class="ruby-constant">Page</span>.<span class="ruby-identifier">new</span>( <span class="ruby-string">&#39;index&#39;</span>, <span class="ruby-identifier">section_path</span> )
<span class="line-num">673</span>     <span class="ruby-identifier">page</span>.<span class="ruby-identifier">prev</span> = <span class="ruby-identifier">index_entries</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">created</span>.<span class="ruby-identifier">strftime</span>( <span class="ruby-string">&quot;%Y/%m/index&quot;</span> )
<span class="line-num">674</span>     <span class="ruby-identifier">page</span>.<span class="ruby-identifier">timestamp</span> = <span class="ruby-identifier">index_entries</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">created</span>
<span class="line-num">675</span>     <span class="ruby-identifier">page</span>.<span class="ruby-identifier">updated</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">last_updated</span>( <span class="ruby-identifier">index_entries</span> )
<span class="line-num">676</span>     <span class="ruby-keyword">yield</span> <span class="ruby-value">:page</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">page</span>, <span class="ruby-value">:entries</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">index_entries</span>
<span class="line-num">677</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-skel_monthly" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">skel_monthly</span><span
            class="method-args">( path_storage, section_path ) { |:page =&gt; page, :entries =&gt; entries| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Handler for templates with `monthly&#39; prefix.  These templates will receive a list of entries for each month that has at least one entry created in its time period.  This handler requests monthly pages to be output as `/%Y/%m/index.ext&#39;.</p>
          
          

          
          <div class="method-source-code" id="skel_monthly-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">710</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skel_monthly</span>( <span class="ruby-identifier">path_storage</span>, <span class="ruby-identifier">section_path</span> )
<span class="line-num">711</span>     <span class="ruby-identifier">months</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">get_months</span>( <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">find</span> )
<span class="line-num">712</span>     <span class="ruby-identifier">months</span>.<span class="ruby-identifier">extend</span> <span class="ruby-constant">Hobix</span><span class="ruby-operator">::</span><span class="ruby-constant">Enumerable</span>
<span class="line-num">713</span>     <span class="ruby-identifier">months</span>.<span class="ruby-identifier">each_with_neighbors</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">prev</span>, <span class="ruby-identifier">curr</span>, <span class="ruby-identifier">nextm</span><span class="ruby-operator">|</span> 
<span class="line-num">714</span>         <span class="ruby-identifier">entries</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">within</span>( <span class="ruby-identifier">curr</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">curr</span>[<span class="ruby-value">1</span>] )
<span class="line-num">715</span>         <span class="ruby-identifier">page</span> = <span class="ruby-constant">Page</span>.<span class="ruby-identifier">new</span>( <span class="ruby-identifier">curr</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">strftime</span>( <span class="ruby-string">&quot;%Y/%m/index&quot;</span> ), <span class="ruby-identifier">section_path</span> )
<span class="line-num">716</span>         <span class="ruby-identifier">page</span>.<span class="ruby-identifier">prev</span> = <span class="ruby-identifier">prev</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">strftime</span>( <span class="ruby-string">&quot;%Y/%m/index&quot;</span> ) <span class="ruby-keyword">if</span> <span class="ruby-identifier">prev</span>
<span class="line-num">717</span>         <span class="ruby-identifier">page</span>.<span class="ruby-identifier">next</span> = <span class="ruby-identifier">nextm</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">strftime</span>( <span class="ruby-string">&quot;%Y/%m/index&quot;</span> ) <span class="ruby-keyword">if</span> <span class="ruby-identifier">nextm</span>
<span class="line-num">718</span>         <span class="ruby-identifier">page</span>.<span class="ruby-identifier">timestamp</span> = <span class="ruby-identifier">curr</span>[<span class="ruby-value">1</span>]
<span class="line-num">719</span>         <span class="ruby-identifier">page</span>.<span class="ruby-identifier">updated</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">last_updated</span>( <span class="ruby-identifier">entries</span> )
<span class="line-num">720</span>         <span class="ruby-keyword">yield</span> <span class="ruby-value">:page</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">page</span>, <span class="ruby-value">:entries</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">entries</span>
<span class="line-num">721</span>     <span class="ruby-keyword">end</span>
<span class="line-num">722</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-skel_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">skel_path</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="skel_path-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">360</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skel_path</span>; <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>( <span class="ruby-ivar">@skel_path</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">default_skel_path</span>, <span class="ruby-ivar">@path</span> ).<span class="ruby-identifier">untaint</span>; <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-skel_section" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">skel_section</span><span
            class="method-args">( path_storage, section_path ) { |:page =&gt; page, :entries =&gt; entries| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Handler for templates with `section&#39; prefix.  These templates will receive all entries below a given directory.  The handler requests will be output as `/section/index.ext&#39;.</p>
          
          

          
          <div class="method-source-code" id="skel_section-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">768</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skel_section</span>( <span class="ruby-identifier">path_storage</span>, <span class="ruby-identifier">section_path</span> )
<span class="line-num">769</span>     <span class="ruby-identifier">section_map</span> = {}
<span class="line-num">770</span>     <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entry</span><span class="ruby-operator">|</span>
<span class="line-num">771</span>         <span class="ruby-identifier">dirs</span> = <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">split</span>( <span class="ruby-string">&#39;/&#39;</span> )
<span class="line-num">772</span>         <span class="ruby-keyword">while</span> ( <span class="ruby-identifier">dirs</span>.<span class="ruby-identifier">pop</span>; <span class="ruby-identifier">dirs</span>.<span class="ruby-identifier">first</span> )
<span class="line-num">773</span>             <span class="ruby-identifier">section</span> = <span class="ruby-identifier">dirs</span>.<span class="ruby-identifier">join</span>( <span class="ruby-string">&#39;/&#39;</span> )
<span class="line-num">774</span>             <span class="ruby-identifier">section_map</span>[ <span class="ruby-identifier">section</span> ] <span class="ruby-operator">||=</span> []
<span class="line-num">775</span>             <span class="ruby-identifier">section_map</span>[ <span class="ruby-identifier">section</span> ] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">entry</span>
<span class="line-num">776</span>         <span class="ruby-keyword">end</span>
<span class="line-num">777</span>     <span class="ruby-keyword">end</span>
<span class="line-num">778</span>     <span class="ruby-identifier">section_map</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">section</span>, <span class="ruby-identifier">entries</span><span class="ruby-operator">|</span>
<span class="line-num">779</span>         <span class="ruby-identifier">page</span> = <span class="ruby-constant">Page</span>.<span class="ruby-identifier">new</span>( <span class="ruby-node">&quot;/#{ section }/index&quot;</span> )
<span class="line-num">780</span>         <span class="ruby-identifier">page</span>.<span class="ruby-identifier">updated</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">last_updated</span>( <span class="ruby-identifier">entries</span> )
<span class="line-num">781</span>         <span class="ruby-keyword">yield</span> <span class="ruby-value">:page</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">page</span>, <span class="ruby-value">:entries</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">entries</span>
<span class="line-num">782</span>     <span class="ruby-keyword">end</span>
<span class="line-num">783</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-skel_tags" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">skel_tags</span><span
            class="method-args">( path_storage, section_path ) { |:page =&gt; page, :entries =&gt; entries| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Handler for templates with `tags&#39; prefix.  These templates will receive a tag with all entries tagged with it. The handler requests will be output as `/tags/&lt;tag&gt;/index.ext&#39;.</p>
          
          

          
          <div class="method-source-code" id="skel_tags-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">820</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skel_tags</span>( <span class="ruby-identifier">path_storage</span>, <span class="ruby-identifier">section_path</span> ) 
<span class="line-num">821</span>   <span class="ruby-comment"># Get a list of all known tags</span>
<span class="line-num">822</span>   <span class="ruby-identifier">tags</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">find</span>( <span class="ruby-value">:all</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-keyword">true</span> ).<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">tags</span> }.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">uniq</span>
<span class="line-num">823</span>   
<span class="line-num">824</span>   <span class="ruby-identifier">tags</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">tag</span><span class="ruby-operator">|</span>
<span class="line-num">825</span>     <span class="ruby-identifier">entries</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">find</span>.<span class="ruby-identifier">find_all</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">tags</span>.<span class="ruby-identifier">member?</span> <span class="ruby-identifier">tag</span> }
<span class="line-num">826</span>     <span class="ruby-identifier">page</span> = <span class="ruby-constant">Page</span>.<span class="ruby-identifier">new</span>( <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-identifier">join</span>( <span class="ruby-string">&#39;tags&#39;</span>,<span class="ruby-identifier">tag</span>,<span class="ruby-string">&#39;index&#39;</span> ), <span class="ruby-identifier">section_path</span> )
<span class="line-num">827</span>     <span class="ruby-identifier">page</span>.<span class="ruby-identifier">updated</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">last_updated</span>( <span class="ruby-identifier">entries</span> ) 
<span class="line-num">828</span>     <span class="ruby-keyword">yield</span> <span class="ruby-value">:page</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">page</span>, <span class="ruby-value">:entries</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">entries</span>
<span class="line-num">829</span>   <span class="ruby-keyword">end</span>
<span class="line-num">830</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-skel_yearly" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">skel_yearly</span><span
            class="method-args">( path_storage, section_path ) { |:page =&gt; page, :entries =&gt; entries| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Handler for templates with `yearly&#39; prefix.  These templates will receive a list of entries for each month that has at least one entry created in its time period.  This handler requests yearly pages to be output as `/%Y/index.ext&#39;.</p>
          
          

          
          <div class="method-source-code" id="skel_yearly-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">728</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skel_yearly</span>( <span class="ruby-identifier">path_storage</span>, <span class="ruby-identifier">section_path</span> )
<span class="line-num">729</span>     <span class="ruby-identifier">entry_range</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">find</span>
<span class="line-num">730</span>     <span class="ruby-identifier">first_time</span>, <span class="ruby-identifier">last_time</span> = <span class="ruby-identifier">entry_range</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">created</span>, <span class="ruby-identifier">entry_range</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">created</span>
<span class="line-num">731</span>     <span class="ruby-identifier">years</span> = (<span class="ruby-identifier">first_time</span>.<span class="ruby-identifier">year</span><span class="ruby-operator">..</span><span class="ruby-identifier">last_time</span>.<span class="ruby-identifier">year</span>).<span class="ruby-identifier">collect</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">y</span><span class="ruby-operator">|</span>
<span class="line-num">732</span>         [ <span class="ruby-constant">Time</span>.<span class="ruby-identifier">mktime</span>( <span class="ruby-identifier">y</span>, <span class="ruby-value">1</span>, <span class="ruby-value">1</span> ), <span class="ruby-constant">Time</span>.<span class="ruby-identifier">mktime</span>( <span class="ruby-identifier">y</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>, <span class="ruby-value">1</span>, <span class="ruby-value">1</span> ) <span class="ruby-operator">-</span> <span class="ruby-value">1</span> ]
<span class="line-num">733</span>     <span class="ruby-keyword">end</span>
<span class="line-num">734</span>     <span class="ruby-identifier">years</span>.<span class="ruby-identifier">extend</span> <span class="ruby-constant">Hobix</span><span class="ruby-operator">::</span><span class="ruby-constant">Enumerable</span>
<span class="line-num">735</span>     <span class="ruby-identifier">years</span>.<span class="ruby-identifier">each_with_neighbors</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">prev</span>, <span class="ruby-identifier">curr</span>, <span class="ruby-identifier">nextm</span><span class="ruby-operator">|</span> 
<span class="line-num">736</span>         <span class="ruby-identifier">entries</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">within</span>( <span class="ruby-identifier">curr</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">curr</span>[<span class="ruby-value">1</span>] )
<span class="line-num">737</span>         <span class="ruby-identifier">page</span> = <span class="ruby-constant">Page</span>.<span class="ruby-identifier">new</span>( <span class="ruby-identifier">curr</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">strftime</span>( <span class="ruby-string">&quot;%Y/index&quot;</span> ), <span class="ruby-identifier">section_path</span> )
<span class="line-num">738</span>         <span class="ruby-identifier">page</span>.<span class="ruby-identifier">prev</span> = <span class="ruby-identifier">prev</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">strftime</span>( <span class="ruby-string">&quot;%Y/index&quot;</span> ) <span class="ruby-keyword">if</span> <span class="ruby-identifier">prev</span>
<span class="line-num">739</span>         <span class="ruby-identifier">page</span>.<span class="ruby-identifier">next</span> = <span class="ruby-identifier">nextm</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">strftime</span>( <span class="ruby-string">&quot;%Y/index&quot;</span> ) <span class="ruby-keyword">if</span> <span class="ruby-identifier">nextm</span>
<span class="line-num">740</span>         <span class="ruby-identifier">page</span>.<span class="ruby-identifier">timestamp</span> = <span class="ruby-identifier">curr</span>[<span class="ruby-value">1</span>]
<span class="line-num">741</span>         <span class="ruby-identifier">page</span>.<span class="ruby-identifier">updated</span> = <span class="ruby-identifier">path_storage</span>.<span class="ruby-identifier">last_updated</span>( <span class="ruby-identifier">entries</span> )
<span class="line-num">742</span>         <span class="ruby-keyword">yield</span> <span class="ruby-value">:page</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">page</span>, <span class="ruby-value">:entries</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">entries</span>
<span class="line-num">743</span>     <span class="ruby-keyword">end</span>
<span class="line-num">744</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-start" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">start</span><span
            class="method-args">( hobix_yaml )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>After the weblog is initialize, the <code>start</code> method is called with the full system path to the directory containing the configuration.</p>

<p>This method sets up all the paths and loads the plugins.</p>
          
          

          
          <div class="method-source-code" id="start-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">323</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">start</span>( <span class="ruby-identifier">hobix_yaml</span> )
<span class="line-num">324</span>     <span class="ruby-ivar">@hobix_yaml</span> = <span class="ruby-identifier">hobix_yaml</span>
<span class="line-num">325</span>     <span class="ruby-ivar">@path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>( <span class="ruby-identifier">hobix_yaml</span> )
<span class="line-num">326</span>     <span class="ruby-ivar">@sections</span> <span class="ruby-operator">||=</span> {}
<span class="line-num">327</span>     <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>( <span class="ruby-identifier">lib_path</span> )
<span class="line-num">328</span>         <span class="ruby-identifier">$LOAD_PATH</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">lib_path</span>
<span class="line-num">329</span>     <span class="ruby-keyword">end</span>
<span class="line-num">330</span>     <span class="ruby-ivar">@plugins</span> = []
<span class="line-num">331</span>     <span class="ruby-ivar">@requires</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">req</span><span class="ruby-operator">|</span>
<span class="line-num">332</span>         <span class="ruby-identifier">opts</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">333</span>         <span class="ruby-keyword">unless</span> <span class="ruby-identifier">req</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:to_str</span>
<span class="line-num">334</span>             <span class="ruby-identifier">req</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">req</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">first</span>
<span class="line-num">335</span>         <span class="ruby-keyword">end</span>
<span class="line-num">336</span>         <span class="ruby-identifier">plugin_conf</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>( <span class="ruby-ivar">@path</span>, <span class="ruby-identifier">req</span>.<span class="ruby-identifier">gsub</span>( <span class="ruby-regexp">/\W+/</span>, <span class="ruby-string">&#39;.&#39;</span> ) )
<span class="line-num">337</span>         <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span> <span class="ruby-identifier">plugin_conf</span>
<span class="line-num">338</span>             <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;*** Loading #{ plugin_conf }&quot;</span>
<span class="line-num">339</span>             <span class="ruby-identifier">plugin_conf</span> = <span class="ruby-constant">YAML</span><span class="ruby-operator">::</span><span class="ruby-identifier">load_file</span> <span class="ruby-identifier">plugin_conf</span>
<span class="line-num">340</span>             <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>
<span class="line-num">341</span>                 <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge!</span> <span class="ruby-identifier">plugin_conf</span>
<span class="line-num">342</span>             <span class="ruby-keyword">else</span>
<span class="line-num">343</span>                 <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">plugin_conf</span>
<span class="line-num">344</span>             <span class="ruby-keyword">end</span>
<span class="line-num">345</span>         <span class="ruby-keyword">end</span>
<span class="line-num">346</span>         <span class="ruby-ivar">@plugins</span> <span class="ruby-operator">+=</span> <span class="ruby-constant">Hobix</span><span class="ruby-operator">::</span><span class="ruby-constant">BasePlugin</span><span class="ruby-operator">::</span><span class="ruby-identifier">start</span>( <span class="ruby-identifier">req</span>, <span class="ruby-identifier">opts</span>, <span class="ruby-keyword">self</span> )
<span class="line-num">347</span>     <span class="ruby-keyword">end</span>
<span class="line-num">348</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-storage" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">storage</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the storage plugin currently in use.  (There can be only one per weblog.)</p>
          
          

          
          <div class="method-source-code" id="storage-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">467</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">storage</span>
<span class="line-num">468</span>     <span class="ruby-ivar">@plugins</span>.<span class="ruby-identifier">detect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">BaseStorage</span> }
<span class="line-num">469</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-to_yaml_type" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_yaml_type</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the <a href="../YAML.html"><code>YAML</code></a> type information, which expands to tag:hobix.com,2004:weblog.</p>
          
          

          
          <div class="method-source-code" id="to_yaml_type-source">
            <pre>    <span class="ruby-comment"># File lib/hobix/weblog.rb</span>
<span class="line-num">879</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">to_yaml_type</span>
<span class="line-num">880</span>     <span class="ruby-string">&quot;!hobix.com,2004/weblog&quot;</span>
<span class="line-num">881</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>

</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.1.2.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

